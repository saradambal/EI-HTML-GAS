<!--//*******************************************FILE DESCRIPTION*********************************************
//************************************ACCESS_RIGHTS_ACCESS_RIGHTS-SEARCH/UPDATE***********************************************//
DONE BY:SAFIYULLAH.M
//VER 1.1-SD:01/06/2014 ED:04/06/2014;TRACKER NO:651;updated customised error for script error
 VER 1.0-SD:08/06/2014 ED:10/06/2014;TRACKER NO:651;issue corrected and updated failure msg
 VER 0.09-SD:06/06/2014 ED:06/06/2014;TRACKER NO:651;updated file description
 VER 0.08-SD:06/06/2014 ED:06/06/2014;TRACKER NO:651;CHANGED JQUERY LINK
 VER 0.07-31/05/2014 ED:3/06/2014-TRACKER NO:651-issues corrected
 VER 0.06 -31/05/2014 ED:31/05/2014-TRACKER NO :609- INCLUDE CONFIRM MENU
 VER 0.05-20/05/2014 ED:21/05/2015:TRACKER NO:651-INCLUDE SITE MAINTENANCE IN MENU
 VER 0.04- 12/05/2014 ED:17/05/2014;TRACKER NO:651-UPDATED ERROR MSG FROM EILIB,UPDATE RETIURN FLAG IN SCRIPT BY LL AND UPDATE SHARING CALENDER WHILE LOGIN CREATION
     APPLIED PLATFORM MANAGEMENT  IN SP
 VER 0.03-SD:22/01/2014 ED:22/01/2014;TRACKER NO:651-Corrected variable names
 VER 0.02-SD;08/01/2014 ED:13/01/2014:TRACKER NO: 651-Added form for Basic role menu creation and search/update
 VER 0.01 - INITIAL VERSION-SD:09/11/2013 ED:07/01/2014;TRACKER NO: 651-->
 <html>
<head>
<!-----------------------------COMMON JQUERY LINKS START-------------------------->
<!--TO SUPPORT DATE PICKER CSS-->
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css">
<!--TO SUPPORT JQUERY FUNCTIONALITIES-->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<!--TO SUPPORT JQUERY UI FUNCTIONALITIES-->
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
<script src="http://code.jquery.com/jquery-migrate-1.11.1.min.js"></script>
<!-----------------------------COMMON JQUERY LINKS END----------------------------->
<!--TO SUPPORT JQUERY LIB VALIDATION-->
<script src="https://googledrive.com/host/0B5pkfK_IBDxjU1FrR3hVTXB4a28/JQuery.js"></script>
<!--TO SUPPORT FORM CSS-->
<link rel="stylesheet" href="https://googledrive.com/host/0B5pkfK_IBDxjU1FrR3hVTXB4a28/StyleSheet.css">
<script>
var ErrorControl ={MsgBox:'false'}
//FUNCTION TO ALERT TRY CATCH ERROR MESSAGE
function onFailure(ACRMENU_error) {
$(".preloader").hide();
if(ACRMENU_error=="ScriptError: Failed to establish a database connection. Check connection string, username and password.")
{
ACRMENU_error="DB USERNAME/PWD WRONG, PLZ CHK UR CONFIG FILE FOR THE CREDENTIALS."
$('#cssmenu').replaceWith('<center><label class="dberrormsg">'+ACRMENU_error+'</label></center>');
}
else{
$(document).doValidation({rule:'messagebox',prop:{msgtitle:"ACCESS RIGHTS",msgcontent:ACRMENU_error}});
}
}
//function to show msg using confirm msgbox
function ShowConfirmMsg(){
var result = confirm("Do you want to open "+$(this).attr("class")+" "+$(this).text()+" ?");
if(result)
{
$(".preloader").show();
}
return result;
}
$(document).ready(function(){
$("#cssmenu").hide()  
$(".preloader").show();
//FUNCTION TO GET ALL MENUS
google.script.run.withFailureHandler(onFailure).withSuccessHandler(ACRMENU_getallmenu_result).ACRMENU_getallmenu();
//FUNCTION TO SET ALL MENUS
function ACRMENU_getallmenu_result(finalmenu_result)
{
var ACRMENU_finalmenu=finalmenu_result.menu//all menus
var ACRMENU_mainmenu=ACRMENU_finalmenu[0]//main menu
var ARCMENU_first_submenu=ACRMENU_finalmenu[1]//submenu
var ARCMENU_second_submenu=ACRMENU_finalmenu[2]//submenu1
var filelist=ACRMENU_finalmenu[3]//html file name
var script_flag=ACRMENU_finalmenu[4];
var count=0;
var mainmenuItem="";
var submenuItem="";
var sub_submenuItem="";
var url = finalmenu_result.url//get script url based on site or standalone deploy
var ACRMENU_error_msg=finalmenu_result.ACRMENU_errorAarray;
var userStamp=finalmenu_result.UserStamp;
if(ACRMENU_mainmenu.length==0){
var ee_msg=(ACRMENU_error_msg.toString()).replace('[LOGIN ID]',userStamp)
$('#ACRMENU_lbl_errormsg').text(ee_msg)
$('#ACRMENU_lbl_errormsg').show();
$(".preloader").hide();
}
else{

$('#ACRMENU_lbl_errormsg').hide();
for(var i=0;i<ACRMENU_mainmenu.length;i++)//add main menu
{
var main='mainmenu'+i
var submen='submenu'+i;
if(ARCMENU_first_submenu.length==0)
{
mainmenuItem='<li class="active"><a href="'+url+'?page='+filelist[count]+'" class="'+ACRMENU_mainmenu[i]+'" onclick="return ShowConfirmMsg()" >'+ACRMENU_mainmenu[i]+'</a></li>'
}
else
{

mainmenuItem='<li class="has-sub"><a href="#" >'+ACRMENU_mainmenu[i]+'</a><ul class='+submen+'>'
}
$(".ACRMENU_ulclass_mainmenu").append(mainmenuItem);
for(var j=0;j<ARCMENU_first_submenu.length;j++)
{
if(i==j)
{
for(var k=0;k<ARCMENU_first_submenu[j].length;k++)//add submenu1 
{
var sub_submenu='sub_submenu'+j+k;
if(ARCMENU_second_submenu[count].length==0)
{
if(script_flag[count]!='X'){
var file_name=filelist[count]
}
else{

var file_name='HTML-SITE_MAINTENANCE_ERROR'
}
submenuItem='<li class="active"><a href="'+url+'?page='+file_name+'" class="'+ACRMENU_mainmenu[i]+'" onclick="return ShowConfirmMsg()">'+ARCMENU_first_submenu[j][k]+'</a></li></ul>'
}
else
{
submenuItem='<li class="has-sub"><a href="#" >'+ARCMENU_first_submenu[j][k]+'</a><ul class='+sub_submenu+'>'
}
$("."+submen).append(submenuItem);
for(var m=0;m<ARCMENU_second_submenu[count].length;m++)//add submenu2
{
if(script_flag[count][m]!='X'){
var file_name=filelist[count][m]
}
else{
var file_name='HTML-SITE_MAINTENANCE_ERROR'
}
sub_submenuItem='<li class="active"><a href="'+url+'?page='+file_name+'" class="'+ARCMENU_first_submenu[j][k]+'"  onclick="return ShowConfirmMsg()">'+ARCMENU_second_submenu[count][m]+'</a></li>'
$("."+sub_submenu).append(sub_submenuItem);}
count++;
$(".ACRMENU_ulclass_mainmenu").append('</ul></li>');
}
}
}
$(".ACRMENU_ulclass_mainmenu").append('</li>');
}
$("#cssmenu").show()  
$(".preloader").hide(); 
}
}
///
});
</script>
<title>MENU</title>
</head>
<body>
<div class="wrapper">
<div  class="preloader MaskPanel"><div class="preloader statusarea" ><div style="padding-top:90px; text-align:center"><img src="https://googledrive.com/host/0B5pkfK_IBDxjU1FrR3hVTXB4a28/Loading.gif"  /></div></div></div>
<div id='cssmenu' hidden>
<ul class="ACRMENU_ulclass_mainmenu" id="nav"><!--main menu--></ul>
</div>
<label id="ACRMENU_lbl_errormsg" class="errormsg" hidden ></label>
</div>
</body>
</html>